!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Livechat2Sdk",[],t):"object"==typeof exports?exports.Livechat2Sdk=t():e.Livechat2Sdk=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){e.exports=n(7)},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t){function n(e,t,n,r,o,i,s){try{var a=e[i](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var s=e.apply(t,r);function a(e){n(s,o,i,a,u,"next",e)}function u(e){n(s,o,i,a,u,"throw",e)}a(void 0)}))}}},function(e,t,n){var r=n(8),o=n(9),i=n(10),s=n(12);e.exports=function(e,t){return r(e)||o(e,t)||i(e,t)||s()}},function(e,t,n){e.exports=n(13)},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function a(e,t,n,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),s=new k(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return M()}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var a=S(s,n);if(a){if(a===c)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var d=u(e,t,n);if("normal"===d.type){if(r=n.done?"completed":"suspendedYield",d.arg===c)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(r="completed",n.method="throw",n.arg=d.arg)}}}(e,n,s),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=a;var c={};function d(){}function h(){}function l(){}var f={};f[o]=function(){return this};var p=Object.getPrototypeOf,v=p&&p(p(w([])));v&&v!==t&&n.call(v,o)&&(f=v);var g=l.prototype=d.prototype=Object.create(f);function m(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function y(e,t){var r;this._invoke=function(o,i){function s(){return new t((function(r,s){!function r(o,i,s,a){var c=u(e[o],e,i);if("throw"!==c.type){var d=c.arg,h=d.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(h).then((function(e){d.value=e,s(d)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}(o,i,r,s)}))}return r=r?r.then(s,s):s()}}function S(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,c;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function w(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:M}}function M(){return{value:void 0,done:!0}}return h.prototype=g.constructor=l,l.constructor=h,l[s]=h.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},m(y.prototype),y.prototype[i]=function(){return this},e.AsyncIterator=y,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var s=new y(a(t,n,r,o),i);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},m(g),g[s]="Generator",g[o]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=w,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,c):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;b(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:w(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}}},function(e,t,n){var r=n(11);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){"use strict";n.r(t),n.d(t,"Livechat2Api",(function(){return A}));var r=n(1),o=n.n(r),i=n(3),s=n.n(i),a=n(0),u=n.n(a),c=n(2),d=n.n(c),h=n(4),l=n.n(h),f=function e(t,n){var r=this;o()(this,e),u()(this,"endPoint",void 0),u()(this,"callerObj",void 0),u()(this,"trace",void 0),u()(this,"connect",(function(){r.socket=new WebSocket(r.endPoint+"?token=".concat(r.callerObj.session.auth)),r.mid=1e3,r.bEnded=!1,r.socket.onopen=function(e){U.info("Connection : onopen"),r.trace.push(["open"]),r.callerObj.__onConnectOrReconnect()},r.socket.onmessage=function(e){U.info("Connection : onmessage : "+e.data);try{r.trace.push(["in",e.data]),r.callerObj.__onStrMessage(e.data)}catch(e){U.error("Connection : Error in message handler : "+e)}},r.socket.onerror=function(e){U.info("Connection : onerror : "+JSON.stringify(e)),U.error(e.data)},r.socket.onclose=function(e){U.info("Connection : onclose : "+JSON.stringify(e)),r.trace.push(["close"]),r.callerObj.__onDisconnect(e.reason)}})),u()(this,"canSend",(function(){return 1==r.socket.readyState})),u()(this,"hasEnded",(function(){return r.bEnded})),u()(this,"sendMessage",(function(e){return 1!=r.socket.readyState?(U.warn("socket is not connected"),!1):(U.info(e),r.trace.push(["out",e]),r.socket.send(e),!0)})),u()(this,"end",(function(e){U.info(e),r.bEnded=!0,r.socket.close(1e3,e)})),this.endPoint=t,this.callerObj=n,this.trace=[]},p=n(5),v=n.n(p);function g(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function e(){o()(this,e),u()(this,"deserialize",(function(e,t){try{if(e.length<S.body)return console.error("Invalid message : too small"),!1;var n,r=g(w.entries());try{for(r.s();!(n=r.n()).done;){var o=v()(n.value,2),i=o[0],s=o[1];if(e.substring(i,i+s.length)!==s)return console.error("Invalid message : format error"),!1}}catch(e){r.e(e)}finally{r.f()}switch(e.substring(S.type[0],S.type[1]).charAt(0)){case"M":t.setType(k.APP);break;case"A":t.setType(k.ACK);break;case"N":t.setType(k.NACK);break;case"H":t.setType(k.HB);break;case"S":t.setType(k.SS);break;case"E":t.setType(k.SE);break;case"L":t.setType(k.LOG);break;case"R":t.setType(k.STRM);break;default:return console.error("Invalid message : unknown type"),!1}var a=e.substring(S.subtype[0],S.subtype[1]);t.setSubType(a.trim()),a=e.substring(S.mid[0],S.mid[1]);try{t.setMessageID(parseInt(a.trim()))}catch(e){return console.error("Invalid message : Message ID must be a number"),!1}a=e.substring(S.sid[0],S.sid[1]),t.setSessionID(a),t.setExtStrContent(e.substring(S.body))}catch(e){console.error("Unexpected Error has occurred "+e)}return!0})),u()(this,"serialize",(function(t,n){try{if(parseInt(t.getMessageID(),10)>9999)return console.error("Invalid Message Id"),!1;if(t.getSessionID().length>32)return console.error("Invalid Session Id"),!1;if(!(n&&n instanceof I))return console.error("rOutStr is not instance StringBuffer"),!1;n.append("[T]");var r=t.getType();n.append(r),n.append(e.justifyRight(4,null==t.getSubType()?"":t.getSubType())),n.append("[M]"),n.append(e.justifyRight(4,null==t.getMessageID()?"":t.getMessageID())),n.append("[S]"),n.append(e.justifyRight(32,null==t.getSessionID()?"":t.getSessionID())),n.append("[B]"),n.append(t.getExtStrContent())}catch(e){return console.error("Unexpected Error has occurred "+e),!1}return!0}))};u()(y,"justifyRight",(function(e,t){var n=new RegExp(".{"+e+"}$"),r="";do{r+=" "}while(r.length<e);return n.exec(r+t)[0]}));var S=function e(){o()(this,e)};u()(S,"type",[3,4]),u()(S,"subtype",[4,8]),u()(S,"mid",[11,15]),u()(S,"sid",[18,50]),u()(S,"body",53);var I=function(){function e(t){var n=this;o()(this,e),u()(this,"append",(function(e){e&&n.setResult(n.getResult().concat(e))})),u()(this,"toString",(function(){return n.getResult()})),this.result=t||""}return s()(e,[{key:"getResult",value:function(){return this.result}},{key:"setResult",value:function(e){this.result=e}}]),e}(),b=function(){function e(){o()(this,e)}return s()(e,[{key:"getSessionID",value:function(){return this.m_sSessionID}},{key:"setSessionID",value:function(e){this.m_sSessionID=e}},{key:"getMessageID",value:function(){return this.m_iMessageID}},{key:"setMessageID",value:function(e){this.m_iMessageID=e}},{key:"getExtStrContent",value:function(){return this.m_sExtStrContent}},{key:"setExtStrContent",value:function(e){this.m_sExtStrContent=e}},{key:"getSubType",value:function(){return this.m_sSubType}},{key:"getSendState",value:function(){return this.m_eSendState}},{key:"setSendState",value:function(e){this.m_eSendState=e}},{key:"setSubType",value:function(e){this.m_sSubType=e}},{key:"getType",value:function(){return this.m_eType}},{key:"setType",value:function(e){this.m_eType=e}}]),e}(),k={APP:"M",ACK:"A",NACK:"N",HB:"H",SS:"S",SE:"E",LOG:"L",STRM:"R"},w=new Map([[0,"[T]"],[8,"[M]"],[15,"[S]"],[50,"[B]"]]),M=function e(t){var n=this;o()(this,e),u()(this,"storeSession",(function(){sessionStorage.setItem("livechat.session",JSON.stringify(n.session))})),u()(this,"updateSent",(function(){sessionStorage.setItem("livechat.lsent",n.session.mid)})),u()(this,"updateReceived",(function(){sessionStorage.setItem("livechat.lreceived",n.session.lastRecvMid)})),u()(this,"loadSession",(function(){var e=sessionStorage.getItem("livechat.session");if(!e)return!1;try{n.session=JSON.parse(e)}catch(e){return!1}if(!(n.session.sessionID&&n.session.auth&&n.session.userid&&!n.session.bEndReceived))return U.info("Basic session loading failed"),!1;var t=sessionStorage.getItem("livechat.lsent"),r=sessionStorage.getItem("livechat.lreceived");return t&&r?(n.session.mid=parseInt(t),n.session.lastRecvMid=parseInt(r),n.session.mid>=0&&n.session.lastRecvMid>=0||(U.warn("mids are not ints"),!1)):(U.warn("mids not found"),!1)})),u()(this,"clear",(function(){sessionStorage.clear()})),this.session=t},G=function e(t,n){var r=this;o()(this,e),u()(this,"close",(function(){r.scheduleHandle&&clearTimeout(r.scheduleHandle),r.exitNow=!0,r.messageQueue.length=0,r.sentQueue.length=0})),u()(this,"enqueueMessage",(function(e,t,n){var o=r.state.new;console.log("Item for Send : "+e+" "+t),r.messageQueue.push({mid:e,msg:t,state:o,cb:n,t:Date.now(),tc:0})})),u()(this,"ackReceived",(function(e){console.log("Received ack for ".concat(e));for(var t=0;t<r.sentQueue.length;t++){var n=r.sentQueue[t];if(n.mid==e&&n.state!=r.state.sent&&(n.state=r.state.sent,console.log("Raising ack callback for ".concat(n.mid,", Sent length=").concat(r.sentQueue.length)),null!=n.cb)){n.cb(n.mid,!0,r.state.acked);break}}})),u()(this,"nackReceived",(function(e){console.log("Received nack for ".concat(e));for(var t=0;t<r.sentQueue.length;t++){var n=r.sentQueue[t];if(n.mid==e&&(n.state=r.state.sent,console.log("Raising nack callback for ".concat(n.mid,", Sent length=").concat(r.sentQueue.length)),null!=n.cb)){n.cb(n.mid,!1,r.state.nacked);break}}})),u()(this,"countInQueue",(function(){return r.messageQueue.length})),this.connection=t,this.messageQueue=[],this.sentQueue=[],this.state={new:0,sent:1,nacked:2,acked:3,timedout:4},this.options=n||{expiryInMilliseconds:5e3,sentQueueSize:2},this.TE=this.options.expiryInMilliseconds,this.SentSize=this.options.sentQueueSize,this.exitNow=!1,console.log("Expiry in milliseconds=".concat(this.TE," SentQueueSize=").concat(this.SentSize));var i=this,s=null;s=function(){if(!i.connection.hasEnded()||(i.close(),!r.exitNow))if(i.sentQueue.length<=0&&i.messageQueue.length<=0)i.scheduleHandle=setTimeout(s);else{var e=[];if(i.sentQueue.length>0){for(var t={},n=0;n<i.sentQueue.length;n++){var o=i.sentQueue[n];if(o.state!=i.state.sent);else{if(e.push(n),t.hasOwnProperty(o.mid))continue;t[o.mid]=1,console.log("Item for removal : "+o.mid+" "+Date.now())}}for(var a=e.length-1;a>=0;a--)r.sentQueue.splice(e[a],1);e=[];for(var u=0;u<i.sentQueue.length;u++){var c=new Date;if(i.sentQueue[u].t.getTime()<=c.getTime())if(i.sentQueue[u].tc++,i.sentQueue[u].tc>2)console.log("Next: Removing Timed out ".concat(i.sentQueue[u].mid,", Queue length= ").concat(i.messageQueue.length,", Sent length=").concat(r.sentQueue.length)),i.sentQueue[u].state=i.state.timedout,e.push(u),null!=i.sentQueue[u].cb&&i.sentQueue[u].cb(i.sentQueue[u].mid,!1,i.state.nacked);else{console.log("Next: Setting Time out ".concat(i.sentQueue[u].mid,", Queue length= ").concat(i.messageQueue.length,", Sent length=").concat(r.sentQueue.length));var d=Date.now();d+=i.TE,i.sentQueue[u].t=new Date(d),i.sentQueue[u].tc++}}for(a=e.length-1;a>=0;a--)r.sentQueue.splice(e[a],1)}e=[];for(var h=0;h<i.messageQueue.length;h++){var l=i.messageQueue[h];if(i.sentQueue.length<i.SentSize&&i.connection.canSend()){var f=Date.now();f+=i.TE,l.t=new Date(f),i.sentQueue.push(l),console.log("Next: Sending ".concat(l.mid,", Sent length=").concat(r.sentQueue.length)),i.connection.sendMessage(l.msg),e.push(h)}}for(a=e.length-1;a>=0;a--)i.messageQueue.splice(e[a],1);r.exitNow||(i.scheduleHandle=setTimeout(s))}},i.scheduleHandle=setTimeout(s)},U=new function e(){o()(this,e),u()(this,"info",function(){var e=l()(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u()(this,"debug",function(){var e=l()(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.debug(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u()(this,"error",function(){var e=l()(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.error(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u()(this,"warn",function(){var e=l()(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.error(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},N=function e(t){var n=this;o()(this,e),u()(this,"rsender",void 0),u()(this,"setRefreshToken",(function(e){n.session.refreshToken=e})),u()(this,"getRefreshToken",(function(){return n.session.refreshToken})),u()(this,"setWorkspace",(function(e){n.session.workspace=e})),u()(this,"getWorkspace",(function(){return n.session.workspace})),u()(this,"setMyWorkspaces",(function(e){n.session.workspaces=e})),u()(this,"getMyWorkspaces",(function(){return n.session.workspaces})),u()(this,"getmid",(function(){return n.session.mid++})),u()(this,"setLastRecvMid",(function(e){return n.session.lastRecvMid=e})),u()(this,"getLastRecvMid",(function(){return n.session.lastRecvMid})),u()(this,"setSessionID",(function(e){n.session.sessionID=e})),u()(this,"getSessionID",(function(){return n.session.sessionID})),u()(this,"setEndReceived",(function(e,t){n.session.bEndReceived=e,n.session.endReason=t})),u()(this,"setConnected",(function(e){n.session.bConnected=e})),u()(this,"isConnected",(function(){return n.session.bConnected})),u()(this,"isEndReceived",(function(){return n.session.bEndReceived})),u()(this,"start",(function(e,t){n.userData=e,n.fetchStatus=t,n.__onConnectOrReconnect=n.__onConnect,n.$connect()})),u()(this,"open",(function(){return!!n.persist.loadSession()&&(n.session=n.persist.session,n.__onConnectOrReconnect=n.__onReconnect,n.$connect(),!0)})),u()(this,"end",(function(e){n.$sendProxyMessage(k.SE,{auth:n.session.auth,from:n.session.userid,type:"end",content:e},(function(e,t,n){})),n.setEndReceived(!0,e),clearInterval(n.hbInterval),n.persist.clear(),setTimeout((function(){n.connection.end(e)}),2e3)})),u()(this,"sendLv2Message",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0;U.info(t),""!=n.session.sessionID?n.$sendProxyMessage(k.APP,{auth:n.session.auth,from:n.session.userid,type:e,content:t,to:r,attributes:o,org:n.getWorkspace()},i):U.error("No session Id")})),u()(this,"sendLv2StreamMessage",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n.isConnected())if(""!=n.getSessionID()){var o=new b;o.setType(k.STRM),o.setMessageID("0000"),o.setSubType(""),o.setSessionID(n.getSessionID());var i={auth:n.session.auth,from:n.session.userid,content:e,to:t,attributes:r,org:n.getWorkspace()};o.setExtStrContent(JSON.stringify(i));var s=new y,a=new I;s.serialize(o,a);var u=a.toString();n.connection.sendMessage(u)}else U.error("No session Id");else U.error("message dropped due to not being connected")})),u()(this,"addProxyListener",(function(e,t){})),u()(this,"onEnd",(function(e){U.info("Unhandled onEnd")})),u()(this,"onLv2Message",(function(e,t,n,r){U.info("Unhandled onMessage")})),u()(this,"onStartSuccess",(function(e){U.info("Unhandled onStartSuccess")})),u()(this,"onStartFailed",(function(e){U.info("Unhandled onStartFailed")})),u()(this,"processConnStateChanged",(function(e){U.info("Unhandled processConnStateChanged ("+e+")")})),u()(this,"setUserId",(function(e){n.session.userid=e})),u()(this,"setAuthToken",(function(e){n.session.auth=e})),u()(this,"getUserId",(function(){return n.session.userid})),u()(this,"$sendProxyMessage",(function(e,t,r){if(n.isConnected()){var o=new b;o.setType(e),o.setMessageID(n.getmid()),o.setSubType(""),o.setSessionID(n.getSessionID()),o.setExtStrContent(JSON.stringify(t));var i=new y,s=new I;i.serialize(o,s);var a=s.toString(),u=o.getMessageID();n.rsender.enqueueMessage(u,a,(function(e,t,o){null!=r&&r(e,t,o),n.processConnStateChanged(t)}))}else U.error("message dropped due to not being connected")})),u()(this,"__onConnect",(function(){U.info("connected"),n.processConnStateChanged(!0),n.setConnected(!0),n.session.userid||U.warn("UserID not set"),n.session.auth||U.warn("AuthToken not set"),n.setLastRecvMid(-1),n.$sendProxyMessage(k.SS,{auth:n.session.auth,from:n.session.userid,type:"start",content:n.userData,attributes:n.fetchStatus},(function(e,t,r){t||n.onStartFailed()})),n.__onConnectOrReconnect=n.__onReconnect})),u()(this,"__onReconnect",(function(){U.info("reconnected"),n.setConnected(!0),n.processConnStateChanged(!0),n.$startHB()})),u()(this,"__onConnectOrReconnect",(function(){})),u()(this,"$connect",(function(){n.connection.connect()})),u()(this,"$sendAck",(function(e){e.setType(k.ACK),e.setExtStrContent("");var t=new y,r=new I;t.serialize(e,r);var o=r.toString();n.connection.sendMessage(o)})),u()(this,"$startHB",(function(){U.info("Start sending HB"),""!=n.session.sessionID?n.hbInterval=setInterval((function(){n.$sendProxyMessage(k.HB,{})}),1e4):U.error("No session Id")})),u()(this,"$onProxyAppMessage",(function(e,t){var r=JSON.parse(e);if("startstatus"==r.type){var o=r.content;return"string"==typeof o&&(o=JSON.parse(o)),void(o.status?(n.setSessionID(t),n.persist.storeSession(),n.onStartSuccess(t),n.$startHB()):n.onStartFailed(r.content))}n.onLv2Message(r.type,r.content,r.from,r.attributes)})),u()(this,"__onStrMessage",(function(e){try{var t=new y,r=new b;if(!t.deserialize(e,r))return void U.info("Deserialize issue");var o=r.getType();U.info("msgType: "+o);var i=n.getLastRecvMid(),s=r.getMessageID(),a=r.getExtStrContent();if(U.info("content : "+a),o==k.ACK)return n.persist.updateSent(s),void n.rsender.ackReceived(s);if(o==k.NACK){if(n.rsender.nackReceived(s),""!==a)try{"NoSessionFound"===JSON.parse(a).reasonCode&&(clearInterval(n.hbInterval),n.persist.clear(),n.onEnd("NoSessionFound"),n.connection.end("NoSessionFound"))}catch(e){U.error("Unable to parse NACK content: "+e)}return}if(n.$sendAck(r),-1!=i&&i+1!=s){if(U.info("last received mid: "+i+", current mid: "+s),i==s)return void U.warn("Duplicate message, ignored");i<s?U.error("Potential message miss"):U.error("unusual mid sequence")}if(n.setLastRecvMid(s),n.persist.updateReceived(s),o==k.APP)return void n.$onProxyAppMessage(a,r.getSessionID());if(o==k.SE)return n.setEndReceived(!0,a.reason),clearInterval(n.hbInterval),n.persist.clear(),void n.onEnd(a.reason)}catch(e){U.error("Error in onNewMessage: "+e)}})),u()(this,"__onDisconnect",(function(e){U.info("onDisconnect : "+e),n.setConnected(!1),n.processConnStateChanged(!1),clearInterval(n.hbInterval),n.isEndReceived()?U.info("end of comm : "+n.session.endReason):""!=n.session.sessionID?n.$connect():U.info("No reconnect as session has not been started")})),this.url=t+"/ws-chat-proxy/ws/chat",this.session={mid:1e3,lastRecvMid:-1,sessionID:null,bEndReceived:"false",endReason:null,auth:null,refreshToken:null,workspace:null,workspaces:[],userid:null,bConnected:!1},this.setEndReceived(!1),this.setConnected(!1),this.setSessionID(""),this.connection=new f(this.url,this),this.rsender=new G(this.connection),this.persist=new M(this.session)},L=function e(){o()(this,e),u()(this,"Name",void 0),u()(this,"Id",void 0),u()(this,"CreatedDateTime",void 0),u()(this,"Description",void 0),u()(this,"CreatedBy",void 0),u()(this,"Participants",void 0),u()(this,"IconPath",void 0),this.Name="",this.Id="",this.CreatedDateTime=new Date,this.Description="",this.CreatedBy="",this.Participants=[],this.IconPath=""},R=function e(){o()(this,e),u()(this,"GroupId",void 0),u()(this,"ParticipantsModifiedDateTime",void 0),u()(this,"Participants",void 0),u()(this,"RequestorUserId",void 0),this.GroupId="",this.ParticipantsModifiedDateTime=new Date,this.Participants=[],this.RequestorUserId=""},T=function e(){o()(this,e),u()(this,"Id",void 0),u()(this,"Name",void 0),u()(this,"RequestorUserId",void 0),this.Id="",this.Name="",this.RequestorUserId=""},D=function e(){o()(this,e),u()(this,"Id",void 0),u()(this,"Description",void 0),u()(this,"RequestorUserId",void 0),this.Id="",this.Description="",this.RequestorUserId=""},P=function e(){o()(this,e),u()(this,"Id",void 0),u()(this,"RequestorUserId",void 0),this.Id="",this.RequestorUserId=""},E=function e(){o()(this,e),u()(this,"UserId",void 0),u()(this,"LastMessageId",void 0),this.UserId="",this.LastMessageId=0},O=function e(){o()(this,e),u()(this,"GroupId",void 0),u()(this,"UserId",void 0),u()(this,"RequestorUserId",void 0),this.GroupId="",this.UserId="",this.RequestorUserId=""},x=function e(){o()(this,e),u()(this,"GroupId",void 0),u()(this,"IconPath",void 0),u()(this,"RequestorUserId",void 0),this.GroupId="",this.IconPath="",this.RequestorUserId=""},C={userNotLoggedIn:"User is not logged in"},A=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wss://"+window.location.host;o()(this,e),u()(this,"livechat",void 0),u()(this,"init",(function(){t.livechat=new N(t.url),t.livechat.onEnd=function(e){t.onEnd(e)},t.livechat.onStartSuccess=function(e){t.onStartSuccess(e)},t.livechat.onStartFailed=function(e){t.onStartFailed(e)},t.livechat.processConnStateChanged=function(e){t.serverOnlineState!==e&&(t.serverOnlineState=e,setTimeout((function(){t.onServerStateChange(e)}),0))},t.msgmap={"user-message":function(e,n){t.onUserMessage(e,n)},"typing-state":function(e,n){t.onTypingState(JSON.parse(e),n)},"delivery-recipt":function(e,n){t.onDeliveryRecipt(e,n)},"read-recipt":function(e,n){t.onReadRecipt(e,n)},"group-created":function(e,n){t.onGroupCreated(JSON.parse(e))},"group-name-updated":function(e,n){t.onGroupNameModified(JSON.parse(e))},"group-description-updated":function(e,n){t.onGroupDescriptionModified(JSON.parse(e))},"group-deleted":function(e,n){t.onGroupDeleted(e)},"group-message":function(e,n){t.onGroupMessageReceived(JSON.parse(e))},"user-group-listing":function(e,n){t.onUserGroupListing(JSON.parse(e))},"participants-added":function(e,n){t.onUserAddedToGroup(JSON.parse(e))},"participants-removed":function(e,n){t.onUserRemovedFromGroup(JSON.parse(e))},presence:function(e){t.onPresenceNotification(e)},"user-found":function(e,n){t.onUserFound(JSON.parse(e))},"request-queued":function(e,n){t.onRequestQueued(JSON.parse(e))},"queue-position-updated":function(e,n){t.onQueuePositionUpdated(JSON.parse(e))},"app-event":function(e,n){t.onAppEvent(e)},"group-admin-added":function(e,n){t.onGroupAdminAdded(JSON.parse(e))},"group-admin-dismissed":function(e,n){t.onGroupAdminDismissed(JSON.parse(e))},"user-left-group":function(e,n){t.onUserLeftGroup(JSON.parse(e))},"group-icon-changed":function(e,n){t.onGroupIconChanged(JSON.parse(e))},"user-not-found":function(e,n){t.onUserNotFound(JSON.parse(e))}},t.msglisteners={},t.livechat.onLv2Message=function(e,n,r,o){var i=t.msgmap[e];if(i||(i=t.msglisteners[e]),i)try{i(n,r)}catch(t){U.info("handler ("+e+") threw a exception. "+t)}}})),u()(this,"getLoggedInUserId",(function(){return t.livechat.getUserId()})),u()(this,"registerListener",(function(e,n){t.msglisteners[e]=n})),u()(this,"unregisterListener",(function(e){delete t.msglisteners[e]})),u()(this,"start",(function(e,n){var r={};n&&!0===n&&(r={fetch:"true"}),t.livechat.start(JSON.stringify({eCustDetails:e}),r)})),u()(this,"end",(function(e){t.livechat.end(e)})),u()(this,"sendUserMessage",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;t.livechat.sendLv2Message("user-message",e,n,{},r)})),u()(this,"sendTypingState",(function(e,n){t.livechat.sendLv2Message("typing-state",e,n)})),u()(this,"sendReadRecipt",(function(e,n){t.livechat.sendLv2Message("read-recipt",e,n)})),u()(this,"sendAppEvent",(function(e,n){t.livechat.sendLv2Message("app-event",e,n)})),u()(this,"open",(function(){return t.livechat.open()})),u()(this,"onEnd",(function(e){U.info("Unhandled onEnd")})),u()(this,"onStartSuccess",(function(e){U.info("Unhandled onStartSuccess")})),u()(this,"onStartFailed",(function(e){U.info("Unhandled onStartFailed")})),u()(this,"onUserMessage",(function(e,t){U.info("Unhandled onUserMessage : "+e+", from : "+t)})),u()(this,"onTypingState",(function(e,t){U.info("Unhandled Typing State")})),u()(this,"onDeliveryRecipt",(function(e){U.info("Unhandled delivery recipt")})),u()(this,"onReadRecipt",(function(e){U.info("Unhandled read recipt")})),u()(this,"onPresenceNotification",(function(e){U.info("Unhandled presence notif")})),u()(this,"onAppEvent",(function(e){U.info("Unhandled Application Event")})),u()(this,"onServerStateChange",(function(e){U.info("Unhandled onServerStateChange ("+e+")")})),u()(this,"sendStreamMessage",(function(e){try{if(null==e||void 0===e||""===e)return void U.error("Parameter (message) in Method (sendStreamMessage) cannot be blank");t.livechat.sendLv2StreamMessage(e,"service:TMC")}catch(e){U.error("Error in sendStreamMessage: ",e)}})),u()(this,"createGroup",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";try{var i=new Date,s=t.livechat.getUserId();if(null==e||void 0===e||""===e)return void U.error("Parameter (name) in Method (createGroup) cannot be blank");if(null==r)return void U.error("Parameter (description) in Method (createGroup) cannot be null/undefined");if(null==n)return void U.error("Parameter (userIdList) in Method (createGroup) cannot be null/undefined");if(0===n.length)return void U.error("Parameter (userIdList) in Method (createGroup) has to have atleast one user ID added");if(null==s||""===s)return void U.error(C.userNotLoggedIn);-1===n.indexOf(s)&&n.push(s);var a=new L;a.Name=e,a.CreatedDateTime=i,a.Description=r,a.Participants=n,a.CreatedBy=s,a.IconPath=o,t.livechat.sendLv2Message("create-group",JSON.stringify(a),"service:GMS")}catch(e){U.error("Error in createGroup: "+e)}})),u()(this,"onGroupCreated",(function(e){U.info("Group created with below parameters:\n Group ID: "+e.Id+"\nGroup Name: "+e.Name+"\nGroup Icon: "+e.IconPath+"\nGroup Description: "+e.Description+"\nCreated By: "+e.CreatedBy+"\nCreated Date Time: "+e.CreatedDateTime+"\nGroup Participants: "+JSON.stringify(e.Participants))})),u()(this,"deleteGroup",(function(e){try{new Date;var n=t.livechat.getUserId();if(null==e||void 0===e||""===e)return void U.error("Parameter (groupId) in Method (deleteGroup) cannot be blank");if(null==n||""===n)return void U.error(C.userNotLoggedIn);var r=new P;r.Id=e,r.RequestorUserId=n,t.livechat.sendLv2Message("delete-group",JSON.stringify(r),"service:GMS")}catch(e){U.error("Error in deleteGroup: ",e)}})),u()(this,"onGroupDeleted",(function(e){U.info("Group "+e+" is deleted")})),u()(this,"addUserToGroup",(function(e,n){try{var r=new Date,o=t.livechat.getUserId();if(null==e||void 0===e||""===e)return void U.error("Parameter (groupId) in Method (addUserToGroup) cannot be blank");if(null==n||void 0===n||""===n||0===n.length)return void U.error("Parameter (userIdList) in Method (addUserToGroup) cannot be blank");if(null==o||""===o)return void U.error(C.userNotLoggedIn);var i=new R;i.GroupId=e,i.ParticipantsModifiedDateTime=r,i.Participants=n,i.RequestorUserId=o,t.livechat.sendLv2Message("add-participants",JSON.stringify(i),"service:GMS")}catch(e){U.error("Error in addUserToGroup: ",e)}})),u()(this,"onUserAddedToGroup",(function(e){U.info("Group created with below parameters:\n Group ID: "+e.Id+"\nGroup Name: "+e.Name+"\nGroup Description: "+e.Description+"\nCreated By: "+e.CreatedBy+"\nCreated Date Time: "+e.CreatedDateTime+"\nGroup Participants: "+JSON.stringify(e.Participants))})),u()(this,"removeUserFromGroup",(function(e,n){try{var r=new Date,o=t.livechat.getUserId();if(null==e||void 0===e||""===e)return void U.error("Parameter (groupId) in Method (removeUserFromGroup) cannot be blank");if(null==n||void 0===n||""===n||0===n.length)return void U.error("Parameter (userIdList) in Method (removeUserFromGroup) cannot be blank");if(null==o||""===o)return void U.error(C.userNotLoggedIn);var i=new R;i.GroupId=e,i.ParticipantsModifiedDateTime=r,i.Participants=n,i.RequestorUserId=o,t.livechat.sendLv2Message("remove-participants",JSON.stringify(i),"service:GMS")}catch(e){U.error("Error in removeUserFromGroup: ",e)}})),u()(this,"onUserRemovedFromGroup",(function(e){U.info("Users "+e.Participants.toString()+" are removed from group with Id "+e.GroupId+" at "+e.ParticipantsModifiedDateTime)})),u()(this,"sendMessageInGroup",(function(e,n){try{if(null==e||void 0===e||""===e)return void U.error("Parameter (groupId) in Method (sendMessageInGroup) cannot be blank");if(null==n||void 0===n||""===n)return void U.error("Parameter (message) in Method (sendMessageInGroup) cannot be blank");t.livechat.sendLv2Message("group-message",n,"group:"+e)}catch(e){U.error("Error in sendMessageInGroup: ",e)}})),u()(this,"onGroupMessageReceived",(function(e){U.info("Group Message Received with details: "+JSON.stringify(e))})),u()(this,"modifyGroupName",(function(e,n){try{new Date;var r=t.livechat.getUserId();if(null==e||void 0===e||""===e)return void U.error("Parameter (groupId) in Method (modifyGroupName) cannot be blank");if(null==n||void 0===n||""===n)return void U.error("Parameter (newGroupName) in Method (modifyGroupName) cannot be blank");if(null==r||""===r)return void U.error(C.userNotLoggedIn);var o=new T;o.Id=e,o.Name=n,o.RequestorUserId=r,t.livechat.sendLv2Message("modify-group-name",JSON.stringify(o),"service:GMS")}catch(e){U.error("Error in modifyGroupName: ",e)}})),u()(this,"onGroupNameModified",(function(e){U.info("Name of the Group with Id "+e.Id+" has been changed to "+e.Name)})),u()(this,"modifyGroupDescription",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{new Date;var r=t.livechat.getUserId();if(null==e||void 0===e||""===e)return void U.error("Parameter (groupId) in Method (modifyGroupDescription) cannot be blank");if(null==n||void 0===n)return void U.error("Parameter (newGroupDescription) in Method (modifyGroupDescription) cannot be blank");if(null==r||""===r)return void U.error(C.userNotLoggedIn);var o=new D;o.Id=e,o.Description=n,o.RequestorUserId=r,t.livechat.sendLv2Message("modify-group-description",JSON.stringify(o),"service:GMS")}catch(e){U.error("Error in modifyGroupDescription: ",e)}})),u()(this,"onGroupDescriptionModified",(function(e){U.info("Name of the Group with Id "+e.Id+" has been changed to "+e.Description)})),u()(this,"getUserGroupList",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{var n=t.livechat.getUserId();if(null==n||""===n)return void U.error(C.userNotLoggedIn);var r=new E;r.LastMessageId=e,r.UserId=n,t.livechat.sendLv2Message("group-listing",JSON.stringify(r),"service:GMS")}catch(e){U.error("Error in getUserGroupList: ",e)}})),u()(this,"onUserGroupListing",(function(e){U.info("Group List received for user Id: "+e.UserId+" \n Last Group Id: "+e.LastGroupListId+" \n Group List Information: "+JSON.stringify(e.GroupListInfo))})),u()(this,"makeUserAsAdmin",(function(e,n){try{var r=t.livechat.getUserId();if(null==e||void 0===e||""===e)return void U.error("Parameter (groupId) in Method (makeUserAsAdmin) cannot be blank");if(null==n||void 0===n)return void U.error("Parameter (userId) in Method (makeUserAsAdmin) cannot be blank");if(null==r||""===r)return void U.error(C.userNotLoggedIn);var o=new O;o.GroupId=e,o.UserId=n,o.RequestorUserId=r,t.livechat.sendLv2Message("make-user-group-admin",JSON.stringify(o),"service:GMS")}catch(e){U.error("Error in makeUserAsAdmin: ",e)}})),u()(this,"onGroupAdminAdded",(function(e){U.info("User  "+e.UserId+" has been made an admin in group "+e.GroupId)})),u()(this,"dismissUserAsAdmin",(function(e,n){try{var r=t.livechat.getUserId();if(null==e||void 0===e||""===e)return void U.error("Parameter (groupId) in Method (dismissUserAsAdmin) cannot be blank");if(null==n||void 0===n)return void U.error("Parameter (userId) in Method (dismissUserAsAdmin) cannot be blank");if(null==r||""===r)return void U.error(C.userNotLoggedIn);var o=new O;o.GroupId=e,o.UserId=n,o.RequestorUserId=r,t.livechat.sendLv2Message("dismiss-user-group-admin",JSON.stringify(o),"service:GMS")}catch(e){U.error("Error in dismissUserAsAdmin: ",e)}})),u()(this,"onGroupAdminDismissed",(function(e){U.info("User  "+e.UserId+" has been dismissed as admin from group "+e.GroupId)})),u()(this,"leaveGroup",(function(e,n){try{var r=t.livechat.getUserId();if(null==e||void 0===e||""===e)return void U.error("Parameter (groupId) in Method (leaveGroup) cannot be blank");if(null==n||void 0===n)return void U.error("Parameter (userId) in Method (leaveGroup) cannot be blank");if(null==r||""===r)return void U.error(C.userNotLoggedIn);var o=new O;o.GroupId=e,o.UserId=n,o.RequestorUserId=r,t.livechat.sendLv2Message("user-left-group",JSON.stringify(o),"service:GMS")}catch(e){U.error("Error in leaveGroup: ",e)}})),u()(this,"onUserLeftGroup",(function(e){U.info("User  "+e.UserId+" has left group "+e.GroupId)})),u()(this,"changeGroupIcon",(function(e,n){try{var r=t.livechat.getUserId();if(null==e||void 0===e||""===e)return void U.error("Parameter (groupId) in Method (changeGroupIcon) cannot be blank");if(null==n||void 0===n)return void U.error("Parameter (iconPath) in Method (changeGroupIcon) cannot be blank");if(null==r||""===r)return void U.error(C.userNotLoggedIn);var o=new x;o.GroupId=e,o.IconPath=n,o.RequestorUserId=r,t.livechat.sendLv2Message("group-icon-change",JSON.stringify(o),"service:GMS")}catch(e){U.error("Error in changeGroupIcon: ",e)}})),u()(this,"onGroupIconChanged",(function(e){U.info("Group "+e.GroupId+" icon has changed ("+e.IconPath+")")})),u()(this,"onUserFound",(function(e){U.info("Found user id:"+e.userId+" requested skill: "+e.reqSkill+" RequestId: "+e.reqId+"user type: "+e.type)})),u()(this,"onRequestQueued",(function(e){U.info("Request queued position :"+e.position+" requested Skill: "+e.reqSkill+" RequestId: "+e.reqId)})),u()(this,"onQueuePositionUpdated",(function(e){U.info("Updated queued position :"+e.position+" requested Skill: "+e.reqSkill+" RequestId: "+e.reqId)})),u()(this,"onUserNotFound",(function(e){U.info(" User Not found for requested Skill: "+e.reqSkill+" RequestId: "+e.reqId)})),u()(this,"findUser",(function(e,n,r){try{var o={};o.reqSkill=e,o.reqId=n,o.customerInfo=r,t.livechat.sendLv2Message("find-user",JSON.stringify(o),"service:ASL")}catch(e){U.error("Error in findUser: ",e)}})),u()(this,"oPath","https://guardian.qa.tetherfi.cloud/login"),u()(this,"loginV2",(function(e,n,r,o){var i=t,s=o?"".concat(o,"/login"):t.oPath;fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:n})}).then((function(e){return e.json()})).then((function(e){e.isSuccess&&e.tokenInfo?(U.info("Login success"),i.livechat.setUserId(e.tokenInfo.userId),i.livechat.setAuthToken(e.tokenInfo.token),i.livechat.setRefreshToken(e.tokenInfo.refreshToken),i.livechat.setWorkspace(e.tokenInfo.organization),i.livechat.setMyWorkspaces(e.tokenInfo.organizations),r(!0,e.tokenInfo.token,e.tokenInfo)):(U.error("Login failed - isSuccess : ".concat(e.isSuccess,", Message : ").concat(e.message,", TokenInfo : ").concat(e.tokenInfo?"NOT NULL":"NULL")),r(!1))})).catch((function(e){U.error("Error in loginRequest : "+e),r(!1)}))})),u()(this,"switchWorkspace",(function(e,n,r,o,i){var s=t,a="".concat(e,"/login/token/").concat(o);fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:n,refreshToken:r})}).then((function(e){return e.json()})).then((function(e){e.isSuccess&&e.tokenInfo?(U.info("Workspace switch success"),s.livechat.setUserId(e.tokenInfo.userId),s.livechat.setAuthToken(e.tokenInfo.token),s.livechat.setWorkspace(e.tokenInfo.organization),i(!0,e.tokenInfo)):(U.error("Workspace switch - isSuccess : ".concat(e.isSuccess,", Message : ").concat(e.message,", TokenInfo : ").concat(e.tokenInfo?"NOT NULL":"NULL")),i(!1))})).catch((function(e){U.error("Error in Workspace switch request : "+e),i(!1)}))})),u()(this,"login",(function(e,n,r){t.init();var o=t,i=t.oPath+"/login";fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:n})}).then((function(e){return e.json()})).then((function(e){if(0==e.status){var t=e.data.authorization,n=e.data.userId;U.info("authToken : "+t+"\nuserId : "+n),void 0!==t&&t&&null!=t?(o.livechat.setUserId(n),o.livechat.setAuthToken(t),r(!0,t)):r(!1)}else U.error("Login Failed"),r(!1)})).catch((function(e){U.error("Error in login Request : "+e),r(!1)}))})),this.url=n,this.serverOnlineState=!1,this.init()}return s()(e,[{key:"sendPresenceNotification",value:function(e){this.livechat.sendLv2Message("presence",e,"service:PRS")}},{key:"sendCustomMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;this.livechat.sendLv2Message(e,t,n,r)}}]),e}()}])}));
//# sourceMappingURL=livechat2sdk-lib.min.js.map